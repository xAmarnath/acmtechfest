<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Dashboard - ASTRISK | ACM AJCE Tech Fest</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.cdnfonts.com/css/valorant" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* ================= BASE STYLES ================= */
        :root {
            --primary-red: #ff003c;
            --dark-bg: #0a0a0a;
        }

        body {
            color: #e5e5e5;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            background-image: url('https://56ktpin8ut.ucarecd.net/1e09c958-9b5a-4501-b491-6c06a5295b34/LzC.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-color: #000000;
        }

        /* Subtle global overlay to blend background with content */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.55));
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            pointer-events: none;
            z-index: 0;
        }

        .font-rajdhani {
            font-family: 'Rajdhani', sans-serif;
        }

        /* Navbar */
        .glassmorphic-nav {
            background: rgba(10, 10, 10, 0.4);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 0, 60, 0.2);
        }

        /* Container */
        .dashboard-container {
            max-width: 1200px;
            margin: 1rem auto;
            padding: 0 0.75rem;
        }

        /* Cards */
        .team-card {
            background: linear-gradient(145deg, rgba(12, 12, 12, 0.75), rgba(6, 6, 6, 0.85));
            backdrop-filter: blur(14px);
            -webkit-backdrop-filter: blur(14px);
            border: 1px solid rgba(255, 0, 60, 0.2);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .team-card:hover {
            border-color: rgba(255, 0, 60, 0.4);
            box-shadow: 0 4px 20px rgba(255, 0, 60, 0.15);
            background: linear-gradient(145deg, rgba(15, 15, 15, 0.8), rgba(5, 5, 5, 0.9));
        }

        /* Auth Card */
        .auth-card {
            background: linear-gradient(145deg, rgba(15, 15, 15, 0.8), rgba(5, 5, 5, 0.85));
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 0, 60, 0.3);
            border-radius: 14px;
            padding: 1.5rem;
            text-align: center;
            max-width: 450px;
            margin: 3rem auto;
        }

        /* Code Input */
        .code-input {
            width: 100%;
            max-width: 180px;
            padding: 0.75rem;
            font-size: 1.25rem;
            font-weight: 700;
            font-family: 'Rajdhani', monospace;
            letter-spacing: 0.3em;
            text-align: center;
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid rgba(255, 0, 60, 0.3);
            border-radius: 8px;
            color: #fff;
            outline: none;
            transition: all 0.3s ease;
        }

        .code-input:focus {
            border-color: var(--primary-red);
            box-shadow: 0 0 20px rgba(255, 0, 60, 0.3);
        }

        /* Buttons */
        .btn-primary {
            background: var(--primary-red);
            color: white;
            border: none;
            padding: 0.625rem 1.25rem;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .btn-primary:hover {
            background: #ff335c;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 0, 60, 0.4);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid rgba(255, 0, 60, 0.3);
            color: #fff;
            padding: 0.5rem 0.875rem;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }

        .btn-outline:hover {
            background: rgba(255, 0, 60, 0.1);
            border-color: var(--primary-red);
        }

        .btn-success {
            background: #00cc66;
            color: #000;
        }

        .btn-danger {
            background: transparent;
            border: 1px solid rgba(255, 0, 60, 0.5);
            color: #ff3366;
        }

        /* Member Items */
        .member-item {
            padding: 0.625rem;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 6px;
            margin-bottom: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .member-item:hover {
            background: rgba(0, 0, 0, 0.6);
            border-color: rgba(255, 0, 60, 0.3);
            transform: translateX(4px);
        }

        .team-lead-item {
            background: linear-gradient(135deg, rgba(255, 0, 60, 0.15), rgba(255, 0, 60, 0.08));
            border: 1px solid rgba(255, 0, 60, 0.3);
        }

        .team-lead-item:hover {
            background: linear-gradient(135deg, rgba(255, 0, 60, 0.25), rgba(255, 0, 60, 0.12));
        }

        /* Request Card */
        .request-item {
            padding: 0.75rem;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 6px;
            margin-bottom: 0.625rem;
            border: 1px solid rgba(255, 0, 60, 0.1);
            position: relative;
            z-index: 10;
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 0.2rem 0.625rem;
            border-radius: 999px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-open {
            background: rgba(255, 0, 60, 0.2);
            color: #ff6688;
            border: 1px solid rgba(255, 0, 60, 0.3);
        }

        .badge-full {
            background: rgba(255, 0, 60, 0.3);
            color: #ff003c;
            border: 1px solid rgba(255, 0, 60, 0.5);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 0, 60, 0.3);
            border-radius: 10px;
            padding: 1.25rem;
            width: 90%;
            max-width: 450px;
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.05);
            }
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }

        @media (max-width: 768px) {
            .toast-container {
                top: 80px;
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }

        .toast {
            background: rgba(17, 17, 17, 0.95);
            border-left: 4px solid;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(400px);
            opacity: 0;
            transition: all 0.3s ease;
            max-width: 100%;
        }

        @media (max-width: 768px) {
            .toast {
                transform: translateY(-100px);
            }
            
            .toast.show {
                transform: translateY(0);
            }
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success {
            border-left-color: #00ff88;
        }

        .toast.error {
            border-left-color: #ff4444;
        }

        .toast.warning {
            border-left-color: #ffaa00;
        }

        .toast.info {
            border-left-color: var(--primary-red);
        }

        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .toast.success .toast-icon {
            color: #00ff88;
        }

        .toast.error .toast-icon {
            color: #ff4444;
        }

        .toast.warning .toast-icon {
            color: #ffaa00;
        }

        .toast.info .toast-icon {
            color: var(--primary-red);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            font-family: 'Rajdhani', sans-serif;
            margin-bottom: 4px;
            color: #fff;
            font-size: 0.95rem;
        }

        .toast-message {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        .toast-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0;
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            transition: color 0.2s;
        }

        .toast-close:hover {
            color: #fff;
        }

        .payment-button {
            background: #00cc66;
            color: #000;
            border: none;
            padding: 0.75rem 1.5rem;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 0.75rem;
            font-size: 0.95rem;
        }

        .payment-button:hover {
            background: #00dd77;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 204, 102, 0.3);
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="glassmorphic-nav fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="/" class="flex items-center space-x-2">
                        <span class="font-rajdhani text-2xl font-bold tracking-wider" style="color: var(--primary-red);">ASTRISK</span>
                    </a>
                </div>
                <div class="hidden md:flex space-x-4">
                    <a href="/" class="btn-outline" style="padding: 0.5rem 1rem;">Home</a>
                    <a href="/teams" class="btn-outline" style="padding: 0.5rem 1rem;">All Teams</a>
                    <a href="/game.html" class="btn-outline" style="padding: 0.5rem 1rem;">Rules</a>
                    <button id="logoutBtn" class="btn-outline" style="padding: 0.5rem 1rem; display: none;">
                        <svg class="inline-block w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle;">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Auth Screen (shown when not authenticated) -->
    <div id="authScreen" class="dashboard-container" style="padding-top: 5rem;">
        <div class="auth-card">
            <h1 class="font-rajdhani text-3xl font-bold mb-2" style="color: var(--primary-red);">TEAM DASHBOARD</h1>
            <p class="text-gray-400 mb-6">Enter your 4-digit team access code to manage your team</p>
            
            <div class="mb-6">
                <input type="text" id="teamCodeInput" class="code-input" maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="off">
            </div>
            
            <button id="unlockBtn" class="btn-primary" style="width: 100%; max-width: 200px;">
                <span>UNLOCK</span>
            </button>
            
            <!-- Help Section -->
            <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(0, 157, 255, 0.05); border: 1px solid rgba(0, 157, 255, 0.2); border-radius: 8px; backdrop-filter: blur(10px);">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="#00d4ff">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                    <span style="color: #00d4ff; font-weight: 700; font-size: 0.8rem; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Need Help?</span>
                </div>
                <p style="color: #ccc; font-size: 0.85rem; line-height: 1.5; margin: 0 0 0.5rem 0;">
                    Your 4-digit access code was shown after creating your team.
                </p>
                <p style="color: #999; font-size: 0.8rem; line-height: 1.4; margin: 0;">
                    <strong style="color: #ffaa00;">Lost your code?</strong> Contact <a href="https://wa.me/917592021168" style="color: #00ff88; text-decoration: none; font-weight: 600; transition: color 0.2s;" onmouseover="this.style.color='#00dd77'" onmouseout="this.style.color='#00ff88'">Admin on WhatsApp</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Dashboard (shown after authentication) -->
    <div id="dashboardScreen" class="dashboard-container" style="padding-top: 4rem; display: none;">
        
        <!-- Team Header Card -->
        <div class="team-card">
            <div class="flex justify-between items-start flex-wrap gap-3">
                <div>
                    <div class="flex items-center gap-2 mb-1">
                        <h1 class="font-rajdhani text-2xl font-bold" style="color: var(--primary-red);" id="teamNameDisplay">‚Äî</h1>
                        <span id="teamStatusBadge" class="badge badge-open">OPEN</span>
                    </div>
                    <p class="text-gray-400 text-sm" id="teamCollegeDisplay">‚Äî</p>
                </div>
                <div class="text-right">
                    <p class="text-xs text-gray-500 mb-1">Team Code</p>
                    <div class="flex items-center gap-2">
                        <span class="font-rajdhani text-xl font-bold" style="color: var(--primary-red);" id="teamCodeDisplay">----</span>
                        <button id="copyCodeBtn" class="btn-outline" style="padding: 0.375rem 0.625rem; font-size: 0.75rem;">COPY</button>
                    </div>
                </div>
            </div>
            
            <div class="mt-3 flex gap-2 flex-wrap">
                <button id="refreshBtn" class="btn-outline">
                    <svg class="inline-block w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                    <span>REFRESH</span>
                </button>
                <button id="toggleOpenBtn" class="btn-outline">
                    <svg id="toggleOpenIcon" class="inline-block w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                    <span id="toggleOpenText">CLOSE TEAM</span>
                </button>
                <button id="addMemberBtn" class="btn-primary">
                    <svg class="inline-block w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    <span>ADD MEMBER</span>
                </button>
                <button id="paymentBtn" style="display: none; background: #00ff88; color: #000; border: 1px solid #00ff88; padding: 0.625rem 1rem; border-radius: 4px; font-weight: 700; font-family: 'Rajdhani', sans-serif; cursor: pointer; transition: all 0.2s; align-items: center; gap: 0.5rem;" onmouseover="this.style.background='#00dd77'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,255,136,0.3)';" onmouseout="this.style.background='#00ff88'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                    <svg style="width: 16px; height: 16px; vertical-align: middle; display: inline-block;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                    </svg>
                    <span id="paymentBtnText" style="vertical-align: middle; display: inline-block;">PROCEED TO PAYMENT</span>
                </button>
            </div>
            
            <!-- Payment Unlock Disclaimer -->
            <div id="paymentDisclaimer" style="display: none; margin-top: 1rem; padding: 0.9rem 1rem; border-radius: 8px; background: rgba(255, 170, 0, 0.08); border: 1px solid rgba(255, 170, 0, 0.25); backdrop-filter: blur(10px);">
                <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                    <div style="flex-shrink: 0;">
                        <svg style="width: 20px; height: 20px; fill: #ffaa00;" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                        </svg>
                    </div>
                    <div style="flex: 1;">
                        <h4 style="color: #ffaa00; font-weight: 700; font-size: 0.9rem; margin: 0 0 0.4rem 0; font-family: 'Rajdhani', sans-serif;">‚ö†Ô∏è PAYMENT LOCKED</h4>
                        <p style="color: #ccc; font-size: 0.85rem; line-height: 1.5; margin: 0;">
                            Your team needs <span style="color: #ffaa00; font-weight: 600;">at least 5 members</span> to unlock payment and confirm your registration. 
                            <span style="display: block; margin-top: 0.3rem; color: #999; font-size: 0.8rem;">
                                Currently: <span id="disclaimerMemberCount" style="color: #ff003c; font-weight: 600;">0</span>/5 members
                            </span>
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Payment Instructions (shown before clicking payment button) -->
            <div id="paymentInstructionsPre" style="display: none; margin-top: 1rem; padding: 1rem; border-radius: 8px; background: rgba(0, 255, 136, 0.05); border: 1px solid rgba(0, 255, 136, 0.2);">
                <h3 style="color: #00ff88; font-weight: 700; font-size: 0.95rem; margin-bottom: 0.6rem; font-family: 'Rajdhani', sans-serif;">üí≥ PAYMENT INSTRUCTIONS</h3>
                <div style="color: #ccc; font-size: 0.85rem; line-height: 1.6;">
                    <p style="margin-bottom: 0.5rem;">‚Ä¢ Registration Fee: <span style="color: #00ff88; font-weight: 600;">‚Çπ600</span></p>
                    <p style="margin-bottom: 0.5rem;">‚Ä¢ Payment will redirect you to the events portal</p>
                    <p style="margin-bottom: 0.5rem;">‚Ä¢ Complete signup and payment process there</p>
                    <p style="margin-bottom: 0;">‚Ä¢ After payment, you'll be redirected to event details</p>
                </div>
            </div>
            
            <!-- Payment Instructions (shown after clicking payment button) -->
            <div id="paymentInstructions" style="display: none; margin-top: 1rem; padding: 0.8rem; border-radius: 8px; background: rgba(15,15,15,0.85); border: 1px solid rgba(255,0,60,0.15);">
                <div style="display: flex; align-items: flex-start; gap: 0.7rem; margin-bottom: 0.5rem;">
                    <p style="color: #ffaa00; font-weight: 600; margin-bottom: 0.3rem; font-size: 0.9rem;">üìù Step 1: Sign up on the events portal</p>
                    <p style="color: #ccc; font-size: 0.85rem;">A new window has been opened. Please complete your signup there.</p>
                </div>
                <div style="background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); border-radius: 8px; padding: 0.8rem; margin-bottom: 0.6rem;">
                    <p style="color: #00ff88; font-weight: 600; margin-bottom: 0.3rem; font-size: 0.9rem;">‚úì Step 2: Return here after signup</p>
                    <p style="color: #ccc; font-size: 0.85rem;">Click the button above after completing signup.</p>
                </div>
                <div style="background: rgba(255, 0, 60, 0.1); border: 1px solid rgba(255, 0, 60, 0.3); border-radius: 8px; padding: 0.8rem;">
                    <p style="color: #ff3366; font-weight: 600; margin-bottom: 0.3rem; font-size: 0.9rem;">üí≥ Step 3: We will verify your payment</p>
                    <p style="color: #ccc; font-size: 0.85rem;">We will verify your payment and update your team status.</p>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Left Column: Team Members -->
            <div>
                <div class="team-card">
                    <h2 class="font-rajdhani text-lg font-bold mb-3" style="color: var(--primary-red);">TEAM MEMBERS</h2>
                    <div id="membersList">
                        <p class="text-gray-500 text-sm">Loading members...</p>
                    </div>
                </div>
            </div>

            <!-- Right Column: Join Requests -->
            <div>
                <div class="team-card">
                    <h2 class="font-rajdhani text-lg font-bold mb-3" style="color: var(--primary-red);">JOIN REQUESTS</h2>
                    <div id="requestsList">
                        <p class="text-gray-500 text-sm">No pending requests</p>
                    </div>
                </div>

                <!-- Team Stats -->
                <div class="team-card">
                    <h2 class="font-rajdhani text-lg font-bold mb-3" style="color: var(--primary-red);">TEAM STATUS</h2>
                    <div class="space-y-1.5">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Total Members:</span>
                            <span class="font-bold" id="statTotalMembers">0</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Open Slots:</span>
                            <span class="font-bold" style="color: var(--primary-red);" id="statOpenSlots">0</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Pending Requests:</span>
                            <span class="font-bold" style="color: #ffaa00;" id="statPendingRequests">0</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-400">Payment Status:</span>
                            <span class="font-bold" id="statPaymentStatus" style="color: #ffaa00;">PENDING</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Member Modal -->
    <div id="addMemberModal" class="modal">
        <div class="modal-content">
            <h2 class="font-rajdhani text-xl font-bold mb-3" style="color: var(--primary-red);">ADD TEAM MEMBER</h2>
            <div class="space-y-3">
                <div>
                    <label class="block text-xs text-gray-400 mb-1">Name</label>
                    <input type="text" id="newMemberName" class="w-full p-2 text-sm bg-black/60 border border-gray-700 rounded" placeholder="Enter full name">
                </div>
                <div>
                    <label class="block text-xs text-gray-400 mb-1">Email</label>
                    <input type="email" id="newMemberEmail" class="w-full p-2 text-sm bg-black/60 border border-gray-700 rounded" placeholder="Enter email address">
                </div>
                <div>
                    <label class="block text-xs text-gray-400 mb-1">Contact</label>
                    <input type="tel" id="newMemberContact" class="w-full p-2 text-sm bg-black/60 border border-gray-700 rounded" placeholder="10-digit phone number">
                </div>
                <div>
                    <label class="block text-xs text-gray-400 mb-1">Riot ID</label>
                    <input type="text" id="newMemberRiotID" class="w-full p-2 text-sm bg-black/60 border border-gray-700 rounded" placeholder="In-game Riot ID">
                </div>
                <div class="flex gap-2 pt-1">
                    <button id="confirmAddMemberBtn" class="btn-primary flex-1">ADD MEMBER</button>
                    <button id="cancelAddMemberBtn" class="btn-outline flex-1">CANCEL</button>
                </div>
            </div>
        </div>
    </div>
    <footer class="py-16 relative overflow-hidden" style="background: linear-gradient(180deg, #000000 0%, #0a0a0a 50%, #000000 100%); border-top: 1px solid rgba(255,0,60,0.2);">
        <!-- Animated background -->
        <div class="absolute inset-0 opacity-10">
            <div class="absolute inset-0" style="background-image: radial-gradient(circle at 2px 2px, rgba(255,0,60,0.3) 1px, transparent 0); background-size: 40px 40px;"></div>
        </div>
        
        <div class="container mx-auto px-6 text-center relative z-10" style="max-width:900px;">
            <div style="padding:2rem 1rem;">
                <!-- Logo/Brand -->
                <h3 class="text-3xl font-bold mb-4" style="font-family:'valorant',sans-serif;background: linear-gradient(135deg, #ff003c 0%, #ff6b6b 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">ASTERISK 2025</h3>
                
                <!-- Tagline -->
                <p class="text-gray-400 mb-6 font-rajdhani text-lg">Where Code Meets Combat</p>
                
                <!-- Social Links -->
                <div class="flex justify-center gap-6 mb-8">
                    <a href="#" class="social-icon-footer" style="display:inline-flex;align-items:center;justify-content:center;width:50px;height:50px;background:rgba(255,0,60,0.1);border:2px solid #ff003c;border-radius:50%;color:#ff003c;font-size:1.5rem;transition:all 0.3s ease;" onmouseover="this.style.background='#ff003c';this.style.color='#fff';this.style.transform='scale(1.1)';" onmouseout="this.style.background='rgba(255,0,60,0.1)';this.style.color='#ff003c';this.style.transform='scale(1)';">üì∏</a>
                    <a href="#" class="social-icon-footer" style="display:inline-flex;align-items:center;justify-content:center;width:50px;height:50px;background:rgba(255,0,60,0.1);border:2px solid #ff003c;border-radius:50%;color:#ff003c;font-size:1.5rem;transition:all 0.3s ease;" onmouseover="this.style.background='#ff003c';this.style.color='#fff';this.style.transform='scale(1.1)';" onmouseout="this.style.background='rgba(255,0,60,0.1)';this.style.color='#ff003c';this.style.transform='scale(1)';">üê¶</a>
                    <a href="#" class="social-icon-footer" style="display:inline-flex;align-items:center;justify-content:center;width:50px;height:50px;background:rgba(255,0,60,0.1);border:2px solid #ff003c;border-radius:50%;color:#ff003c;font-size:1.5rem;transition:all 0.3s ease;" onmouseover="this.style.background='#ff003c';this.style.color='#fff';this.style.transform='scale(1.1)';" onmouseout="this.style.background='rgba(255,0,60,0.1)';this.style.color='#ff003c';this.style.transform='scale(1)';">üíº</a>
                </div>
                
                <!-- Divider -->
                <div style="height:2px;background:linear-gradient(90deg, transparent, #ff003c, #ff6b6b, transparent);margin:2rem 0;opacity:0.3;"></div>
                
                <!-- Copyright -->
                <p style="font-family:'Rajdhani',sans-serif;font-size:1.1rem;color:#fff;letter-spacing:0.08em;margin-bottom:0.5rem;">
                    &copy; 2025 ACM Student Chapter, Amal Jyothi College of Engineering
                </p>
                
                <!-- Credits -->
                <p style="color:#888;font-size:0.9rem;font-family:'Rajdhani',sans-serif;letter-spacing:0.05em;margin-bottom:1rem;">
                    Designed & Developed by <span style="color:#ff003c;font-weight:600;">Amarnath C</span> and <span style="color:#ff003c;font-weight:600;">Amal Benny Joseph</span>
                </p>
                
                <!-- Contact Info -->
                <p style="color:#999;font-size:0.95rem;font-family:'Rajdhani',sans-serif;letter-spacing:0.05em;margin-bottom:1.5rem;">
                    <span style="color:#ff003c;font-weight:600;">Edwin</span> - <a href="tel:+916282325276" style="color:#ddd;text-decoration:none;transition:color 0.3s ease;" onmouseover="this.style.color='#ff003c';" onmouseout="this.style.color='#ddd';">+91 62823 25276</a>
                </p>
                
                <!-- Contact Button -->
                <a href="tel:+916282325276" style="display:inline-block;color:#fff;background:#ff003c;padding:0.75rem 2rem;border-radius:25px;text-decoration:none;font-weight:700;font-family:'Rajdhani',sans-serif;text-transform:uppercase;letter-spacing:0.1em;box-shadow:0 5px 20px rgba(255,0,60,0.4);transition:all 0.3s ease;" onmouseover="this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 30px rgba(255,0,60,0.6)';this.style.background='#e6003a';" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 5px 20px rgba(255,0,60,0.4)';this.style.background='#ff003c';">‚òé CALL US</a>
            </div>
        </div>
    </footer>

    <script>
        const API_BASE_URL = 'https://30c61382b1f2.ngrok-free.app';
        
        // State
        let teamData = null;
        let teamAuth = null;
        let teamName = null;

        // DOM Elements
        const authScreen = document.getElementById('authScreen');
        const dashboardScreen = document.getElementById('dashboardScreen');
        const teamCodeInput = document.getElementById('teamCodeInput');
        const unlockBtn = document.getElementById('unlockBtn');

        // Toast notification system (matches teams.html)
        function showToast(type, title, message, duration = 5000) {
            const toastContainer = document.getElementById('toastContainer');
            if (!toastContainer) {
                console.error('Toast container not found');
                return;
            }
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: '‚úì',
                error: '‚úï',
                warning: '‚ö†',
                info: '‚Ñπ'
            };

            toast.innerHTML = `
                <div class="toast-icon">${icons[type]}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">√ó</button>
            `;

            toastContainer.appendChild(toast);

            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 10);

            // Auto remove after duration
            if (duration > 0) {
                setTimeout(() => {
                    if (toast.parentElement) {
                        toast.classList.remove('show');
                        setTimeout(() => toast.remove(), 300);
                    }
                }, duration);
            }

            return toast;
        }

        // Verify team code and unlock dashboard
        async function verifyAndUnlock() {
            const code = teamCodeInput.value.trim();
            if (!code || code.length < 4) {
                showToast('error', 'Invalid Code', 'Please enter a 4-digit code');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/team/verify-code`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ code })
                });

                const data = await response.json();
                
                if (response.ok && data.success) {
                    teamAuth = code;
                    teamName = data.team_name;
                    
                    // Store auth AND team name in localStorage for auto-login
                    try {
                        localStorage.setItem(`team_auth_${teamName}`, teamAuth);
                        localStorage.setItem('last_team_name', teamName);
                    } catch (e) {
                        console.error('LocalStorage error:', e);
                    }

                    // Show dashboard
                    authScreen.style.display = 'none';
                    dashboardScreen.style.display = 'block';
                    
                    // Show logout button
                    document.getElementById('logoutBtn').style.display = 'inline-block';
                    
                    showToast('success', 'Success', 'Dashboard unlocked successfully!');
                    
                    // Load team data
                    await loadTeamData();
                } else {
                    showToast('error', 'Authentication Failed', data.message || 'Invalid team code');
                }
            } catch (error) {
                console.error('Verification error:', error);
                showToast('error', 'Network Error', 'Please try again');
            }
        }

        // Load team data from API using /get-team endpoint
        async function loadTeamData() {
            if (!teamName) return;

            try {
                const headers = { 'Content-Type': 'application/json' };
                const perKey = localStorage.getItem(`team_auth_${teamName}`);
                if (perKey) {
                    headers['X-Team-Auth'] = perKey;
                } else {
                    showToast('error', 'Authentication Required', 'Please re-enter your code');
                    return;
                }

                const response = await fetch(`${API_BASE_URL}/get-team?team_name=${encodeURIComponent(teamName)}`, { headers });
                const data = await response.json();

                if (data && data.success && data.team) {
                    teamData = data.team;
                    renderTeamData();
                } else {
                    showToast('error', 'Error', data.message || 'Team not found');
                }
            } catch (error) {
                console.error('Load team error:', error);
                showToast('error', 'Network Error', 'Failed to load team data');
            }
        }

        // Render team data in dashboard
        function renderTeamData() {
            if (!teamData) return;

            // Update header
            document.getElementById('teamNameDisplay').textContent = teamData.team_name;
            document.getElementById('teamCollegeDisplay').textContent = teamData.college_name || 'No college specified';
            document.getElementById('teamCodeDisplay').textContent = teamAuth;
            
            // Update status badge - FULL only when lead + 4 members (not counting substitute)
            const statusBadge = document.getElementById('teamStatusBadge');
            const members = teamData.members || [];
            const memberCount = 1 + members.length; // 1 for lead + regular members (no substitute)
            
            if (memberCount >= 5) {
                statusBadge.textContent = 'FULL';
                statusBadge.className = 'badge badge-full';
            } else {
                statusBadge.textContent = 'OPEN';
                statusBadge.className = 'badge badge-open';
            }
            
            // Update toggle open button
            updateToggleButton();

            // Render members
            renderMembers();
            
            // Render join requests
            renderJoinRequests();
            
            // Update stats
            updateStats();
            
            // Show/hide payment section
            checkPaymentEligibility();
        }
        
        // Update toggle open/close button
        function updateToggleButton() {
            const isOpen = teamData.is_open !== false; // Default to true if not set
            const toggleBtn = document.getElementById('toggleOpenBtn');
            const toggleText = document.getElementById('toggleOpenText');
            const toggleIcon = document.getElementById('toggleOpenIcon');
            
            if (isOpen) {
                toggleText.textContent = 'CLOSE TEAM';
                toggleIcon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>`;
            } else {
                toggleText.textContent = 'OPEN TEAM';
                toggleIcon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"/>`;
            }
        }

        // Render team members
        function renderMembers() {
            const membersList = document.getElementById('membersList');
            membersList.innerHTML = '';
            const paymentCompleted = teamData.payment_status === 'completed';

            // Team Lead
            const lead = teamData.lead;
            if (lead) {
                const leadDiv = document.createElement('div');
                leadDiv.className = 'member-item team-lead-item';
                leadDiv.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.375rem;">
                        <div style="display: flex; align-items: center; gap: 0.375rem;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="#ff003c" stroke="#ff003c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span style="color: #ff003c; font-weight: 700; font-size: 0.7rem; font-family: 'Rajdhani', sans-serif; text-transform: uppercase;">LEAD</span>
                        </div>
                    </div>
                    <div style="color: #fff; font-size: 0.8rem; font-weight: 600; margin-bottom: 0.25rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>${lead.name || 'N/A'}</span>
                        ${lead.name && lead.name !== 'N/A' ? `
                        <button onclick="copyToClipboard('${lead.name}', 'Name')" style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;" title="Copy name">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        ` : ''}
                    </div>
                    ${lead.email && lead.email !== 'N/A' ? `
                    <div style="color: #999; font-size: 0.7rem; display: flex; align-items: center; gap: 0.25rem; margin-bottom: 0.25rem;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="22,6 12,13 2,6" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span style="word-break: break-all;">${lead.email}</span>
                        <button onclick="copyToClipboard('${lead.email}', 'Email')" style="background: none; border: none; cursor: pointer; padding: 0; margin-left: 0.25rem; display: flex; align-items: center;" title="Copy email">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ` : ''}
                    ${lead.contact && lead.contact !== 'N/A' ? `
                    <div style="color: #999; font-size: 0.7rem; display: flex; align-items: center; gap: 0.25rem;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>${lead.contact}</span>
                        <button onclick="copyToClipboard('${lead.contact}', 'Phone')" style="background: none; border: none; cursor: pointer; padding: 0; margin-left: 0.25rem; display: flex; align-items: center;" title="Copy phone">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ` : ''}
                `;
                membersList.appendChild(leadDiv);
            }

            // Regular Members
            const members = teamData.members || [];
            members.forEach((member, index) => {
                const memberDiv = document.createElement('div');
                memberDiv.className = 'member-item';
                memberDiv.style.position = 'relative';
                memberDiv.innerHTML = `
                    ${!paymentCompleted ? `
                    <button onclick="deleteMember('${member.email}')" style="position: absolute; top: 0.5rem; right: 0.5rem; background: rgba(255,0,60,0.1); border: 1px solid rgba(255,0,60,0.3); border-radius: 4px; padding: 0.25rem; cursor: pointer; display: flex; align-items: center; transition: all 0.2s;" title="Remove member" onmouseover="this.style.background='rgba(255,0,60,0.2)'" onmouseout="this.style.background='rgba(255,0,60,0.1)'">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <line x1="18" y1="6" x2="6" y2="18" stroke="#ff003c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <line x1="6" y1="6" x2="18" y2="18" stroke="#ff003c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                    ` : ''}
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.25rem;">
                        <div style="display: flex; align-items: center; gap: 0.375rem;">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="12" cy="7" r="4" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span style="color: #999; font-weight: 600; font-size: 0.7rem; font-family: 'Rajdhani', sans-serif;">M${index + 1}</span>
                        </div>
                    </div>
                    <div style="color: #fff; font-size: 0.8rem; font-weight: 600; margin-bottom: 0.25rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>${member.name || 'N/A'}</span>
                        ${member.name && member.name !== 'N/A' ? `
                        <button onclick="copyToClipboard('${member.name}', 'Name')" style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;" title="Copy name">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                        ` : ''}
                    </div>
                    ${member.email && member.email !== 'N/A' ? `
                    <div style="color: #999; font-size: 0.7rem; display: flex; align-items: center; gap: 0.25rem; margin-bottom: 0.25rem;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="22,6 12,13 2,6" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span style="word-break: break-all;">${member.email}</span>
                        <button onclick="copyToClipboard('${member.email}', 'Email')" style="background: none; border: none; cursor: pointer; padding: 0; margin-left: 0.25rem; display: flex; align-items: center;" title="Copy email">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ` : ''}
                    ${member.contact && member.contact !== 'N/A' ? `
                    <div style="color: #999; font-size: 0.7rem; display: flex; align-items: center; gap: 0.25rem;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>${member.contact}</span>
                        <button onclick="copyToClipboard('${member.contact}', 'Phone')" style="background: none; border: none; cursor: pointer; padding: 0; margin-left: 0.25rem; display: flex; align-items: center;" title="Copy phone">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ` : ''}
                `;
                membersList.appendChild(memberDiv);
            });

            // Substitute
            const substitute = teamData.substitute;
            if (substitute && substitute.name) {
                const subDiv = document.createElement('div');
                subDiv.className = 'member-item';
                subDiv.style.borderColor = 'rgba(255, 0, 60, 0.3)';
                subDiv.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.375rem;">
                        <div style="display: flex; align-items: center; gap: 0.375rem;">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="none" stroke="#ff003c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span style="color: #ff003c; font-weight: 700; font-size: 0.7rem; font-family: 'Rajdhani', sans-serif; text-transform: uppercase;">SUBSTITUTE</span>
                        </div>
                    </div>
                    <div style="color: #fff; font-size: 0.8rem; font-weight: 600; margin-bottom: 0.25rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>${substitute.name}</span>
                        <button onclick="copyToClipboard('${substitute.name}', 'Name')" style="background: none; border: none; cursor: pointer; padding: 0; display: flex; align-items: center;" title="Copy name">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ${substitute.email && substitute.email !== 'N/A' ? `
                    <div style="color: #999; font-size: 0.7rem; display: flex; align-items: center; gap: 0.25rem; margin-bottom: 0.25rem;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="22,6 12,13 2,6" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span style="word-break: break-all;">${substitute.email}</span>
                        <button onclick="copyToClipboard('${substitute.email}', 'Email')" style="background: none; border: none; cursor: pointer; padding: 0; margin-left: 0.25rem; display: flex; align-items: center;" title="Copy email">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ` : ''}
                    ${substitute.contact && substitute.contact !== 'N/A' ? `
                    <div style="color: #999; font-size: 0.7rem; display: flex; align-items: center; gap: 0.25rem;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>${substitute.contact}</span>
                        <button onclick="copyToClipboard('${substitute.contact}', 'Phone')" style="background: none; border: none; cursor: pointer; padding: 0; margin-left: 0.25rem; display: flex; align-items: center;" title="Copy phone">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="opacity: 0.6; transition: opacity 0.2s;">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="#999" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    ` : ''}
                `;
                membersList.appendChild(subDiv);
            }
        }

        // Copy to clipboard helper function
        function copyToClipboard(text, label) {
            if (navigator.clipboard && text) {
                navigator.clipboard.writeText(text).then(() => {
                    showToast('success', 'Copied', `${label} copied to clipboard!`);
                }).catch(err => {
                    console.error('Copy failed:', err);
                    showToast('error', 'Copy Failed', 'Could not copy to clipboard');
                });
            }
        }

        // Render join requests
        function renderJoinRequests() {
            const requestsList = document.getElementById('requestsList');
            requestsList.innerHTML = '';

            const requests = (teamData.join_requests || []).filter(r => r.status === 'pending');
            
            if (requests.length === 0) {
                requestsList.innerHTML = '<p class="text-gray-500 text-sm">No pending requests</p>';
                return;
            }

            requests.forEach(request => {
                const reqDiv = document.createElement('div');
                reqDiv.className = 'request-item';
                
                // Create Riot ID link if available
                const riotIdHtml = request.riot_id ? `
                    <div class="text-xs text-gray-400 mt-1">
                        <span style="color: #999;">Riot ID:</span> 
                        <a href="https://tracker.gg/valorant/profile/riot/${encodeURIComponent(request.riot_id)}/overview" 
                           target="_blank" 
                           style="color: #ff003c; text-decoration: none; font-weight: 600; transition: color 0.2s;"
                           onmouseover="this.style.color='#ff6b6b'"
                           onmouseout="this.style.color='#ff003c'">
                            ${request.riot_id} 
                            <svg class="inline-block w-3 h-3 ml-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>
                            </svg>
                        </a>
                    </div>
                ` : '';
                
                reqDiv.innerHTML = `
                    <div class="mb-2">
                        <div class="font-bold text-sm mb-0.5">${request.name}</div>
                        <div class="text-xs text-gray-400">${request.email}</div>
                        <div class="text-xs text-gray-400">${request.contact}</div>
                        ${riotIdHtml}
                    </div>
                    <div class="flex gap-2">
                        <button class="flex-1 text-xs" onclick="handleRequest('${request.email}', 'accept')" 
                                style="padding: 0.5rem; background: rgba(0, 255, 136, 0.1); border: 1px solid rgba(0, 255, 136, 0.3); color: #00ff88; border-radius: 4px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
                                onmouseover="this.style.background='rgba(0, 255, 136, 0.2)'; this.style.borderColor='rgba(0, 255, 136, 0.5)';"
                                onmouseout="this.style.background='rgba(0, 255, 136, 0.1)'; this.style.borderColor='rgba(0, 255, 136, 0.3)';">
                            <svg class="inline-block w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                            </svg>
                            ACCEPT
                        </button>
                        <button class="flex-1 text-xs" onclick="handleRequest('${request.email}', 'decline')" 
                                style="padding: 0.5rem; background: rgba(255, 0, 60, 0.1); border: 1px solid rgba(255, 0, 60, 0.3); color: #ff003c; border-radius: 4px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
                                onmouseover="this.style.background='rgba(255, 0, 60, 0.2)'; this.style.borderColor='rgba(255, 0, 60, 0.5)';"
                                onmouseout="this.style.background='rgba(255, 0, 60, 0.1)'; this.style.borderColor='rgba(255, 0, 60, 0.3)';">
                            <svg class="inline-block w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                            </svg>
                            DECLINE
                        </button>
                    </div>
                `;
                requestsList.appendChild(reqDiv);
            });
        }

        // Handle join request (accept/decline)
        async function handleRequest(email, action) {
            if (!teamName) return;

            try {
                const headers = { 'Content-Type': 'application/json' };
                const perKey = localStorage.getItem(`team_auth_${teamName}`);
                if (perKey) {
                    headers['X-Team-Auth'] = perKey;
                }

                const response = await fetch(`${API_BASE_URL}/team/respond-join`, {
                    method: 'POST',
                    headers,
                    body: JSON.stringify({
                        team_name: teamName,
                        requester_email: email,
                        action
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    showToast('success', 'Request Processed', `Request ${action}ed successfully!`);
                    await loadTeamData();
                } else {
                    showToast('error', 'Error', data.message || 'Failed to process request');
                }
            } catch (error) {
                console.error('Handle request error:', error);
                showToast('error', 'Network Error', 'Could not process request');
            }
        }

        // Update team stats
        function updateStats() {
            const members = teamData.members || [];
            const substitute = teamData.substitute && teamData.substitute.name ? 1 : 0;
            const totalMembers = 1 + members.length + substitute; // 1 for lead
            
            // Calculate open slots: 5 - (lead + members)
            const openSlots = Math.max(0, 5 - (1 + members.length));
            
            const pendingRequests = (teamData.join_requests || []).filter(r => r.status === 'pending').length;
            
            document.getElementById('statTotalMembers').textContent = totalMembers;
            document.getElementById('statOpenSlots').textContent = openSlots;
            document.getElementById('statPendingRequests').textContent = pendingRequests;
            
            const paymentStatus = document.getElementById('statPaymentStatus');
            if (teamData.payment_status === 'completed') {
                paymentStatus.textContent = 'COMPLETED';
                paymentStatus.style.color = '#00ff88';
            } else {
                paymentStatus.textContent = 'PENDING';
                paymentStatus.style.color = '#ffaa00';
            }
        }

        // Check payment eligibility - only show when lead + 4 members = 5 total
        function checkPaymentEligibility() {
            const members = teamData.members || [];
            const memberCount = 1 + members.length; // 1 for lead + regular members (no substitute counted)
            
            const paymentBtn = document.getElementById('paymentBtn');
            const paymentInstructionsPre = document.getElementById('paymentInstructionsPre');
            const paymentDisclaimer = document.getElementById('paymentDisclaimer');
            const disclaimerMemberCount = document.getElementById('disclaimerMemberCount');
            
            if (memberCount >= 5 && teamData.payment_status !== 'completed') {
                // Team has 5 members - show payment button
                paymentBtn.style.display = 'inline-flex';
                paymentInstructionsPre.style.display = 'block';
                paymentDisclaimer.style.display = 'none';
            } else if (teamData.payment_status !== 'completed') {
                // Team doesn't have 5 members yet - show disclaimer
                paymentBtn.style.display = 'none';
                paymentInstructionsPre.style.display = 'none';
                paymentDisclaimer.style.display = 'block';
                disclaimerMemberCount.textContent = memberCount;
            } else {
                // Payment already completed - hide everything
                paymentBtn.style.display = 'none';
                paymentInstructionsPre.style.display = 'none';
                paymentDisclaimer.style.display = 'none';
            }
        }

        // Add member modal
        const addMemberModal = document.getElementById('addMemberModal');
        const addMemberBtn = document.getElementById('addMemberBtn');
        const confirmAddMemberBtn = document.getElementById('confirmAddMemberBtn');
        const cancelAddMemberBtn = document.getElementById('cancelAddMemberBtn');

        addMemberBtn.addEventListener('click', () => {
            addMemberModal.style.display = 'flex';
        });

        cancelAddMemberBtn.addEventListener('click', () => {
            addMemberModal.style.display = 'none';
            document.getElementById('newMemberName').value = '';
            document.getElementById('newMemberEmail').value = '';
            document.getElementById('newMemberContact').value = '';
            document.getElementById('newMemberRiotID').value = '';
        });

        confirmAddMemberBtn.addEventListener('click', async () => {
            const name = document.getElementById('newMemberName').value.trim();
            const email = document.getElementById('newMemberEmail').value.trim();
            const contact = document.getElementById('newMemberContact').value.trim();
            const riotId = document.getElementById('newMemberRiotID').value.trim();

            if (!name || !email || !contact || !riotId) {
                showToast('warning', 'Missing Information', 'Please fill all fields including Riot ID');
                return;
            }

            try {
                // Create join request with Riot ID
                const response = await fetch(`${API_BASE_URL}/team/join-request`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        team_name: teamName,
                        requester: { name, email, contact, riot_id: riotId }
                    })
                });

                const data = await response.json();
                
                if (!data.success) {
                    showToast('error', 'Error', data.message || 'Failed to add member');
                    return;
                }

                // Auto-accept the request
                const perKey = localStorage.getItem(`team_auth_${teamName}`);
                const headers = { 'Content-Type': 'application/json' };
                if (perKey) {
                    headers['X-Team-Auth'] = perKey;
                }

                const acceptResponse = await fetch(`${API_BASE_URL}/team/respond-join`, {
                    method: 'POST',
                    headers,
                    body: JSON.stringify({
                        team_name: teamName,
                        requester_email: email,
                        action: 'accept'
                    })
                });

                const acceptData = await acceptResponse.json();
                
                if (acceptData.success) {
                    showToast('success', 'Member Added', 'Member added successfully!');
                    addMemberModal.style.display = 'none';
                    document.getElementById('newMemberName').value = '';
                    document.getElementById('newMemberEmail').value = '';
                    document.getElementById('newMemberContact').value = '';
                    document.getElementById('newMemberRiotID').value = '';
                    await loadTeamData();
                } else {
                    showToast('error', 'Error', acceptData.message || 'Could not accept member');
                }
            } catch (error) {
                console.error('Add member error:', error);
                showToast('error', 'Network Error', 'Could not add member');
            }
        });

        // Copy code button
        document.getElementById('copyCodeBtn').addEventListener('click', () => {
            if (navigator.clipboard && teamAuth) {
                navigator.clipboard.writeText(teamAuth);
                showToast('success', 'Copied', 'Team code copied to clipboard!');
            }
        });

        // Refresh button
        document.getElementById('refreshBtn').addEventListener('click', loadTeamData);
        
        // Toggle open/close button
        document.getElementById('toggleOpenBtn').addEventListener('click', async () => {
            if (!teamName || !teamData) return;
            
            try {
                const currentStatus = teamData.is_open !== false; // Default to true if not set
                const newStatus = !currentStatus;
                
                const headers = { 'Content-Type': 'application/json' };
                const perKey = localStorage.getItem(`team_auth_${teamName}`);
                if (perKey) {
                    headers['X-Team-Auth'] = perKey;
                }
                
                const response = await fetch(`${API_BASE_URL}/team/toggle-open`, {
                    method: 'POST',
                    headers,
                    body: JSON.stringify({
                        team_name: teamName,
                        is_open: newStatus
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    teamData.is_open = newStatus;
                    updateToggleButton();
                    const statusText = newStatus ? 'open for join requests' : 'closed for join requests';
                    showToast('success', 'Team Status Updated', `Team is now ${statusText}`);
                } else {
                    showToast('error', 'Error', data.message || 'Failed to update team status');
                }
            } catch (error) {
                console.error('Toggle open error:', error);
                showToast('error', 'Network Error', 'Could not update team status');
            }
        });

        // Payment button
        let paymentWindow = null;

        // Delete member function
        async function deleteMember(memberEmail) {
            if (teamData.payment_status === 'completed') {
                showToast('error', 'Cannot Delete', 'Members cannot be removed after payment is completed');
                return;
            }

            if (!confirm(`Are you sure you want to remove this member?\n\nEmail: ${memberEmail}`)) {
                return;
            }

            try {
                const perKey = localStorage.getItem(`team_auth_${teamName}`);
                const headers = { 'Content-Type': 'application/json' };
                if (perKey) {
                    headers['X-Team-Auth'] = perKey;
                }

                const response = await fetch(`${API_BASE_URL}/team/remove-member`, {
                    method: 'POST',
                    headers,
                    body: JSON.stringify({
                        team_name: teamName,
                        member_email: memberEmail
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    showToast('success', 'Member Removed', 'Member has been removed from the team');
                    await loadTeamData();
                } else {
                    showToast('error', 'Error', data.message || 'Could not remove member');
                }
            } catch (error) {
                console.error('Delete member error:', error);
                showToast('error', 'Network Error', 'Could not remove member');
            }
        }

        // Payment flow functions
        function proceedToPayment() {
            if (teamData.payment_status === 'completed') {
                showToast('info', 'Already Paid', 'Payment has already been completed');
                return;
            }

            // Open signup page in new window
            paymentWindow = window.open('https://events.amaljyothi.ac.in/', '_blank', 'width=1200,height=800');

            // Update button and show instructions
            const paymentBtn = document.getElementById('paymentBtn');
            const paymentBtnText = document.getElementById('paymentBtnText');
            const paymentInstructions = document.getElementById('paymentInstructions');
            const paymentInstructionsPre = document.getElementById('paymentInstructionsPre');

            paymentBtnText.textContent = "I'VE SIGNED UP - NEXT STEP";
            paymentBtn.onclick = confirmSignupAndRedirect;
            paymentInstructionsPre.style.display = 'none';
            paymentInstructions.style.display = 'block';

            showToast('info', 'Signup Portal Opened', 'Complete signup in the new window and return here', 5000);
        }

        function confirmSignupAndRedirect() {
            // Close the signup window if still open
            if (paymentWindow && !paymentWindow.closed) {
                paymentWindow.close();
            }

            showToast('success', 'Redirecting', 'Taking you to the event page...', 2000);

            // Redirect to the specific event page
            setTimeout(() => {
                window.location.href = 'https://e.ajce.in/eqzfhg';
            }, 2000);
        }

        document.getElementById('paymentBtn').addEventListener('click', proceedToPayment);

        // Logout function
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear localStorage auth for this team
                if (teamName) {
                    localStorage.removeItem(`team_auth_${teamName}`);
                    localStorage.removeItem('last_team_name');
                }
                
                // Clear session data
                teamAuth = null;
                teamName = null;
                teamData = null;
                
                // Hide dashboard, show auth screen
                dashboardScreen.style.display = 'none';
                authScreen.style.display = 'block';
                
                // Hide logout button
                document.getElementById('logoutBtn').style.display = 'none';
                
                // Clear input
                teamCodeInput.value = '';
                
                showToast('success', 'Logged Out', 'You have been logged out successfully');
            }
        }

        // Logout button
        document.getElementById('logoutBtn').addEventListener('click', logout);

        // Unlock button
        unlockBtn.addEventListener('click', verifyAndUnlock);

        // Enter key to unlock
        teamCodeInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                verifyAndUnlock();
            }
        });

        // Check for code in sessionStorage (from registration page) or auto-login from localStorage
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Check URL params first for new team creation
                const urlParams = new URLSearchParams(window.location.search);
                const isNewTeam = urlParams.get('new_team') === 'true';
                
                if (isNewTeam) {
                    // New team created - show welcome modal with auth code
                    const newTeamCode = sessionStorage.getItem('new_team_auth_code');
                    const newTeamName = sessionStorage.getItem('new_team_name');
                    
                    if (newTeamCode && newTeamName) {
                        // Show welcome modal
                        showWelcomeModal(newTeamCode, newTeamName);
                        
                        // Pre-fill the login form
                        teamName = newTeamName;
                        teamCodeInput.value = newTeamCode;
                        
                        // Clean up session storage
                        sessionStorage.removeItem('new_team_auth_code');
                        sessionStorage.removeItem('new_team_name');
                        return;
                    }
                }
                
                // First check if redirected from registration with new team (old method)
                const preCode = sessionStorage.getItem('team_code_for_dashboard');
                const preName = sessionStorage.getItem('team_name_for_dashboard');
                
                if (preCode && preName) {
                    teamName = preName;
                    teamCodeInput.value = preCode;
                    await verifyAndUnlock();
                    sessionStorage.removeItem('team_code_for_dashboard');
                    sessionStorage.removeItem('team_name_for_dashboard');
                    return;
                }

                // Check URL params for team name
                let urlTeamName = urlParams.get('team') || urlParams.get('team_name');
                
                // If no URL param, check for last accessed team
                if (!urlTeamName) {
                    urlTeamName = localStorage.getItem('last_team_name');
                }
                
                if (urlTeamName) {
                    teamName = urlTeamName;
                    // Check if we have stored auth for this team
                    const storedAuth = localStorage.getItem(`team_auth_${teamName}`);
                    if (storedAuth) {
                        // Auto-verify and unlock
                        teamAuth = storedAuth;
                        teamCodeInput.value = storedAuth;
                        authScreen.style.display = 'none';
                        dashboardScreen.style.display = 'block';
                        // Show logout button
                        document.getElementById('logoutBtn').style.display = 'inline-block';
                        await loadTeamData();
                    }
                }
            } catch (e) {
                console.error('Auto-login error:', e);
            }
        });
        
        // Welcome Modal Functions
        function showWelcomeModal(authCode, teamName) {
            const modal = document.getElementById('welcomeModal');
            const codeDisplay = document.getElementById('welcomeAuthCode');
            const nameDisplay = document.getElementById('welcomeTeamName');
            
            if (modal && codeDisplay && nameDisplay) {
                codeDisplay.textContent = authCode;
                nameDisplay.textContent = `Team: ${teamName}`;
                modal.style.display = 'flex';
                
                // Store the auth code and team name for auto-login after modal closes
                modal.dataset.authCode = authCode;
                modal.dataset.teamName = teamName;
                
                // Prevent body scroll
                document.body.style.overflow = 'hidden';
            }
        }
        
        function closeWelcomeModal() {
            const modal = document.getElementById('welcomeModal');
            if (modal) {
                // Get the stored auth code and team name from modal dataset
                const authCode = modal.dataset.authCode;
                const storedTeamName = modal.dataset.teamName;
                
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                
                // Set the teamName and auth code for auto-login
                if (authCode && storedTeamName) {
                    teamName = storedTeamName;
                    teamCodeInput.value = authCode;
                    
                    // Auto-login with the code
                    verifyAndUnlock();
                }
            }
        }
        
        function copyWelcomeCode() {
            const codeDisplay = document.getElementById('welcomeAuthCode');
            if (codeDisplay) {
                const code = codeDisplay.textContent;
                navigator.clipboard.writeText(code).then(() => {
                    showToast('success', 'Copied!', 'Team access code copied to clipboard');
                }).catch(err => {
                    console.error('Copy failed:', err);
                    showToast('error', 'Copy Failed', 'Could not copy code to clipboard');
                });
            }
        }

        // Check for new team on page load
        window.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            
            if (urlParams.get('welcome') === 'true') {
                const teamData = JSON.parse(sessionStorage.getItem('newTeamData') || '{}');
                
                if (teamData.authCode && teamData.teamName) {
                    // Show welcome modal
                    showWelcomeModal(teamData.authCode, teamData.teamName);
                    
                    // Clear session storage
                    sessionStorage.removeItem('newTeamData');
                }
            }
        });
    </script>

    <!-- Welcome Modal for New Teams -->
    <div id="welcomeModal" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.92); z-index: 10002; justify-content: center; align-items: center; backdrop-filter: blur(15px);">
        <div style="background: linear-gradient(145deg, rgba(15, 15, 15, 0.85), rgba(5, 5, 5, 0.9)); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 2px solid rgba(255, 0, 60, 0.3); border-radius: 14px; padding: 1.75rem; max-width: 420px; width: 90%; box-shadow: 0 20px 60px rgba(255, 0, 60, 0.25); position: relative;">
            
            <!-- Title -->
            <div style="text-align: center; margin-bottom: 1.25rem;">
                <div style="display: inline-flex; align-items: center; justify-content: center; width: 56px; height: 56px; background: linear-gradient(135deg, rgba(255, 0, 60, 0.15), rgba(168, 85, 247, 0.1)); border-radius: 50%; margin-bottom: 0.75rem;">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" stroke="#00ff88" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="22 4 12 14.01 9 11.01" stroke="#00ff88" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h2 style="font-family: 'Rajdhani', sans-serif; font-size: 1.5rem; font-weight: 700; color: #fff; margin: 0 0 0.4rem 0; text-transform: uppercase; letter-spacing: 2px;">
                    TEAM CREATED!
                </h2>
                <p id="welcomeTeamName" style="color: #00ff88; font-size: 0.95rem; font-weight: 600; margin: 0;"></p>
            </div>
            
            <!-- Auth Code Display -->
            <div style="background: linear-gradient(135deg, rgba(255, 0, 60, 0.08), rgba(168, 85, 247, 0.08)); border: 2px solid rgba(255, 0, 60, 0.35); border-radius: 10px; padding: 1.25rem; margin-bottom: 1rem; text-align: center;">
                <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#ff003c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                    </svg>
                    <span style="color: #ff9aa2; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; font-family: 'Rajdhani', sans-serif;">Team Access Code</span>
                </div>
                <div id="welcomeAuthCode" style="font-family: 'Courier New', monospace; background: rgba(0, 0, 0, 0.5); padding: 0.9rem 1.25rem; border-radius: 8px; color: #fff; border: 2px solid rgba(255, 0, 60, 0.4); font-size: 2rem; font-weight: 800; letter-spacing: 0.5rem; text-shadow: 0 0 20px rgba(255, 0, 60, 0.6); margin-bottom: 0.75rem;">
                    ----
                </div>
                <button onclick="copyWelcomeCode()" style="background: rgba(255, 0, 60, 0.2); color: #ff003c; border: 1px solid rgba(255, 0, 60, 0.4); padding: 0.6rem 1.25rem; border-radius: 6px; font-weight: 700; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; letter-spacing: 1px;" onmouseover="this.style.background='rgba(255, 0, 60, 0.3)'; this.style.borderColor='rgba(255, 0, 60, 0.6)';" onmouseout="this.style.background='rgba(255, 0, 60, 0.2)'; this.style.borderColor='rgba(255, 0, 60, 0.4)';">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    Copy Code
                </button>
            </div>
            
            <!-- Instructions -->
            <div style="background: rgba(0, 157, 255, 0.05); border: 1px solid rgba(0, 157, 255, 0.2); border-radius: 8px; padding: 0.9rem; margin-bottom: 1.25rem;">
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="#00d4ff">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                    </svg>
                    <span style="color: #00d4ff; font-size: 0.8rem; font-weight: 700; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Important</span>
                </div>
                <ul style="color: #ccc; font-size: 0.85rem; line-height: 1.6; margin: 0; padding-left: 1.25rem;">
                    <li style="margin-bottom: 0.35rem;">Save this code to access your dashboard</li>
                    <li>Get 5 members total before payment</li>
                </ul>
            </div>
            
            <!-- Action Button -->
            <button onclick="closeWelcomeModal()" style="width: 100%; background: linear-gradient(135deg, #ff003c, #cc0030); border: none; color: #fff; padding: 0.9rem; border-radius: 8px; cursor: pointer; font-size: 0.95rem; font-weight: 700; transition: all 0.3s; font-family: 'Rajdhani', sans-serif; text-transform: uppercase; letter-spacing: 1.5px; box-shadow: 0 4px 15px rgba(255, 0, 60, 0.4);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255, 0, 60, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255, 0, 60, 0.4)'">
                Enter Team Dashboard
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>
</body>
</html>
